{% load staticfiles %}
<link rel="stylesheet" type="text/css" href="{% static 'esearch/style.css' %}" />
<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="{% static 'esearch/bootstrap-treeview.js' %}"></script>
{% load get_from_dict %}
{% load get_from_source %}

<!DOCTYPE html>
<html>
  <head>
  </head>
  <body>
  	<div class="container">
      <br>
      <div class="row">
        <hr>
        <h2>Tree Menu</h2>
		<!--
        <div class="col-sm-4">
          <h2>Input</h2>
          <div class="form-group">
            <label for="input-select-node" class="sr-only">Search Tree:</label>
            <input type="input" class="form-control" id="input-select-node" placeholder="Identify node..." value="Parent 1">
          </div>
          <div class="checkbox">
            <label>
              <input type="checkbox" class="checkbox" id="chk-select-multi" value="false">
              Multi Select
            </label>
          </div>
          <div class="checkbox">
            <label>
              <input type="checkbox" class="checkbox" id="chk-select-silent" value="false">
              Silent (No events)
            </label>
          </div>
          <div class="form-group">
              <button type="button" class="btn btn-success select-node" id="btn-select-node">Select Node</button>
          </div>
          <div class="form-group">
            <button type="button" class="btn btn-danger select-node" id="btn-unselect-node">Unselect Node</button>
          </div>
          <div class="form-group">
            <button type="button" class="btn btn-primary select-node" id="btn-toggle-selected">Toggle Node</button>
          </div>
        </div>
  		-->
        <div class="col-sm-4">
          <h2>Tree</h2>
          <div id="treeview-selectable" class=""></div>
        </div>
        <div class="col-sm-4">
          <h2>Events</h2>
          <div id="selectable-output"></div>
        </div>
      </div>

      <div class="row">
	  <h2>Test Elasticsearch output</h2>

		{% if results_list %}
			<ul>
			{% for name in results_list.hits.hits %}
				<li>{{ name|get_from_source:"first_name" }} {{ name|get_from_source:"last_name" }} {{ name|get_from_source:"email" }}</li>
			{% endfor %}
			</ul>
		{% else %}
			<p>No results are available.</p>
		{% endif %}
		
		{% if results_list %}
			<ul>
			{% for name in results_list.hits.hits %}
				<li>{{ name }}</li>
			{% endfor %}
			</ul>
		{% else %}
			<p>No results are available.</p>
		{% endif %}

    </div>
</div> <!-- Container -->


<script type="text/javascript">
$(function() {

var defaultData = [
  {
    text: 'Parent 1',
    href: '#parent1',
    tags: ['4'],
    nodes: [
      {
        text: 'Child 1',
        href: '#child1',
        tags: ['2'],
        nodes: [
          {
            text: 'Grandchild 1',
            href: '#grandchild1',
            tags: ['0']
          },
          {
            text: 'Grandchild 2',
            href: '#grandchild2',
            tags: ['0']
          }
        ]
      },
      {
        text: 'Child 2',
        href: '#child2',
        tags: ['0']
      }
    ]
  },
  {
    text: 'Parent 2',
    href: '#parent2',
    tags: ['0']
  },
  {
    text: 'Parent 3',
    href: '#parent3',
     tags: ['0']
  },
  {
    text: 'Parent 4',
    href: '#parent4',
    tags: ['0']
  },
  {
    text: 'Parent 5',
    href: '#parent5'  ,
    tags: ['0']
  }
];

var initSelectableTree = function() {
  return $('#treeview-selectable').treeview({
  	color: "#428bca",
    data: defaultData,
    multiSelect: $('#chk-select-multi').is(':checked'),
    onNodeSelected: function(event, node) {
      $('#selectable-output').prepend('<p>' + node.text + ' was selected</p>');
    },
    onNodeUnselected: function (event, node) {
      $('#selectable-output').prepend('<p>' + node.text + ' was unselected</p>');
    }
  });
};
initSelectableTree();
//var $selectableTree = initSelectableTree();

//// Form functionality
//var findSelectableNodes = function() {
//  return $selectableTree.treeview('search', [ $('#input-select-node').val(), { ignoreCase: false, exactMatch: false } ]);
//};
//var selectableNodes = findSelectableNodes();
//
//$('#chk-select-multi:checkbox').on('change', function () {
//  console.log('multi-select change');
//  $selectableTree = initSelectableTree();
//  selectableNodes = findSelectableNodes();          
//});

//// Select/unselect/toggle nodes
//$('#input-select-node').on('keyup', function (e) {
//  selectableNodes = findSelectableNodes();
//  $('.select-node').prop('disabled', !(selectableNodes.length >= 1));
//});
//
//$('#btn-select-node.select-node').on('click', function (e) {
//  $selectableTree.treeview('selectNode', [ selectableNodes, { silent: $('#chk-select-silent').is(':checked') }]);
//});
//
//$('#btn-unselect-node.select-node').on('click', function (e) {
//  $selectableTree.treeview('unselectNode', [ selectableNodes, { silent: $('#chk-select-silent').is(':checked') }]);
//});
//
//$('#btn-toggle-selected.select-node').on('click', function (e) {
//  $selectableTree.treeview('toggleNodeSelected', [ selectableNodes, { silent: $('#chk-select-silent').is(':checked') }]);
//});

});
</script>
  </body>
</html>

